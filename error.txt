redis     | 2025-10-05 16:49:15.004 | 1:C 05 Oct 2025 07:49:15.004 * oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo
redis     | 2025-10-05 16:49:15.004 | 1:C 05 Oct 2025 07:49:15.004 * Redis version=7.2.5, bits=64, commit=00000000, modified=0, pid=1, just started
redis     | 2025-10-05 16:49:15.004 | 1:C 05 Oct 2025 07:49:15.004 # Warning: no config file specified, using the default config. In order to specify a config file use redis-server /path/to/redis.conf
redis     | 2025-10-05 16:49:15.005 | 1:M 05 Oct 2025 07:49:15.005 * monotonic clock: POSIX clock_gettime
redis     | 2025-10-05 16:49:15.006 | 1:M 05 Oct 2025 07:49:15.006 * Running mode=standalone, port=6379.
redis     | 2025-10-05 16:49:15.007 | 1:M 05 Oct 2025 07:49:15.007 * Server initialized
redis     | 2025-10-05 16:49:15.007 | 1:M 05 Oct 2025 07:49:15.007 * Loading RDB produced by version 7.2.5
redis     | 2025-10-05 16:49:15.007 | 1:M 05 Oct 2025 07:49:15.007 * RDB age 8 seconds
redis     | 2025-10-05 16:49:15.007 | 1:M 05 Oct 2025 07:49:15.007 * RDB memory usage when created 0.94 Mb
redis     | 2025-10-05 16:49:15.007 | 1:M 05 Oct 2025 07:49:15.007 * Done loading RDB, keys loaded: 1, keys expired: 0.
redis     | 2025-10-05 16:49:15.008 | 1:M 05 Oct 2025 07:49:15.007 * DB loaded from disk: 0.000 seconds
redis     | 2025-10-05 16:49:15.008 | 1:M 05 Oct 2025 07:49:15.007 * Ready to accept connections tcp
db        | 2025-10-05 16:49:15.076 | 
db        | 2025-10-05 16:49:15.076 | PostgreSQL Database directory appears to contain a database; Skipping initialization
db        | 2025-10-05 16:49:15.076 | 
db        | 2025-10-05 16:49:15.115 | 2025-10-05 07:49:15.115 UTC [1] LOG:  starting PostgreSQL 15.7 on x86_64-pc-linux-musl, compiled by gcc (Alpine 13.2.1_git20240309) 13.2.1 20240309, 64-bit
db        | 2025-10-05 16:49:15.115 | 2025-10-05 07:49:15.115 UTC [1] LOG:  listening on IPv4 address "0.0.0.0", port 5432
db        | 2025-10-05 16:49:15.115 | 2025-10-05 07:49:15.115 UTC [1] LOG:  listening on IPv6 address "::", port 5432
db        | 2025-10-05 16:49:15.130 | 2025-10-05 07:49:15.130 UTC [1] LOG:  listening on Unix socket "/var/run/postgresql/.s.PGSQL.5432"
db        | 2025-10-05 16:49:15.147 | 2025-10-05 07:49:15.147 UTC [28] LOG:  database system was shut down at 2025-10-05 07:49:08 UTC
db        | 2025-10-05 16:49:15.219 | 2025-10-05 07:49:15.218 UTC [1] LOG:  database system is ready to accept connections
migration | 2025-10-05 16:49:27.197 | WARNING:google_genai._api_client:Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
migration | 2025-10-05 16:49:27.275 | WARNING:google_genai._api_client:Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
migration | 2025-10-05 16:49:27.298 | INFO:config:–ö–ª–∏–µ–Ω—Ç—ã Gemini —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã.
migration | 2025-10-05 16:49:27.336 | INFO:config:–ö–ª–∏–µ–Ω—Ç Redis —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω.
migration | 2025-10-05 16:49:27.403 | WARNING:root:Encryption module not available: No module named 'utils'. Using plaintext mode.
migration | 2025-10-05 16:49:27.503 | INFO  [alembic.runtime.migration] Context impl PostgresqlImpl.
migration | 2025-10-05 16:49:27.503 | INFO  [alembic.runtime.migration] Will assume transactional DDL.
api       | 2025-10-05 16:49:28.606 | [2025-10-05 07:49:28 +0000] [1] [INFO] Starting gunicorn 23.0.0
api       | 2025-10-05 16:49:28.606 | [2025-10-05 07:49:28 +0000] [1] [INFO] Listening at: http://0.0.0.0:8000 (1)
api       | 2025-10-05 16:49:28.606 | [2025-10-05 07:49:28 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
api       | 2025-10-05 16:49:28.613 | [2025-10-05 07:49:28 +0000] [7] [INFO] Booting worker with pid: 7
api       | 2025-10-05 16:49:28.652 | [2025-10-05 07:49:28 +0000] [8] [INFO] Booting worker with pid: 8
api       | 2025-10-05 16:49:28.665 | [2025-10-05 07:49:28 +0000] [9] [INFO] Booting worker with pid: 9
api       | 2025-10-05 16:49:28.721 | [2025-10-05 07:49:28 +0000] [10] [INFO] Booting worker with pid: 10
api       | 2025-10-05 16:49:30.412 | WARNING:google_genai._api_client:Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
api       | 2025-10-05 16:49:30.433 | WARNING:google_genai._api_client:Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
api       | 2025-10-05 16:49:30.435 | WARNING:google_genai._api_client:Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
api       | 2025-10-05 16:49:30.465 | WARNING:google_genai._api_client:Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
api       | 2025-10-05 16:49:30.475 | WARNING:google_genai._api_client:Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
api       | 2025-10-05 16:49:30.485 | WARNING:google_genai._api_client:Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
api       | 2025-10-05 16:49:30.496 | WARNING:google_genai._api_client:Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
api       | 2025-10-05 16:49:30.510 | INFO:config:–ö–ª–∏–µ–Ω—Ç—ã Gemini —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã.
api       | 2025-10-05 16:49:30.510 | INFO:config:–ö–ª–∏–µ–Ω—Ç Redis —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω.
api       | 2025-10-05 16:49:30.512 | INFO:config:–ö–ª–∏–µ–Ω—Ç—ã Gemini —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã.
api       | 2025-10-05 16:49:30.513 | INFO:config:–ö–ª–∏–µ–Ω—Ç Redis —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω.
api       | 2025-10-05 16:49:30.517 | INFO:utils.encryption:Encryption module —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
api       | 2025-10-05 16:49:30.518 | INFO:utils.encryption:Encryption module —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
api       | 2025-10-05 16:49:30.525 | WARNING:google_genai._api_client:Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
api       | 2025-10-05 16:49:30.531 | INFO:config:–ö–ª–∏–µ–Ω—Ç—ã Gemini —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã.
api       | 2025-10-05 16:49:30.532 | INFO:config:–ö–ª–∏–µ–Ω—Ç Redis —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω.
api       | 2025-10-05 16:49:30.534 | INFO:utils.encryption:Encryption module —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
api       | 2025-10-05 16:49:30.550 | INFO:config:–ö–ª–∏–µ–Ω—Ç—ã Gemini —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã.
api       | 2025-10-05 16:49:30.551 | INFO:config:–ö–ª–∏–µ–Ω—Ç Redis —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω.
api       | 2025-10-05 16:49:30.554 | INFO:utils.encryption:Encryption module —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
api       | 2025-10-05 16:49:30.594 | DEBUG:passlib.utils.compat:loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
api       | 2025-10-05 16:49:30.594 | DEBUG:passlib.utils.compat:loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
api       | 2025-10-05 16:49:30.594 | DEBUG:passlib.utils.compat:loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
api       | 2025-10-05 16:49:30.608 | DEBUG:passlib.utils.compat:loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
api       | 2025-10-05 16:49:30.608 | DEBUG:passlib.utils.compat:loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
api       | 2025-10-05 16:49:30.608 | DEBUG:passlib.utils.compat:loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
api       | 2025-10-05 16:49:30.618 | DEBUG:passlib.utils.compat:loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
api       | 2025-10-05 16:49:30.618 | DEBUG:passlib.utils.compat:loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
api       | 2025-10-05 16:49:30.618 | DEBUG:passlib.utils.compat:loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
api       | 2025-10-05 16:49:30.635 | DEBUG:passlib.registry:registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
api       | 2025-10-05 16:49:30.638 | DEBUG:passlib.utils.compat:loaded lazy attr 'SafeConfigParser': <class 'configparser.ConfigParser'>
api       | 2025-10-05 16:49:30.638 | DEBUG:passlib.utils.compat:loaded lazy attr 'NativeStringIO': <class '_io.StringIO'>
api       | 2025-10-05 16:49:30.638 | DEBUG:passlib.utils.compat:loaded lazy attr 'BytesIO': <class '_io.BytesIO'>
api       | 2025-10-05 16:49:30.647 | DEBUG:passlib.registry:registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
api       | 2025-10-05 16:49:30.654 | DEBUG:asyncio:Using selector: EpollSelector
api       | 2025-10-05 16:49:30.662 | DEBUG:passlib.registry:registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
api       | 2025-10-05 16:49:30.663 | DEBUG:asyncio:Using selector: EpollSelector
api       | 2025-10-05 16:49:30.669 | [2025-10-05 07:49:30 +0000] [8] [INFO] Started server process [8]
api       | 2025-10-05 16:49:30.669 | [2025-10-05 07:49:30 +0000] [8] [INFO] Waiting for application startup.
api       | 2025-10-05 16:49:30.669 | [2025-10-05 07:49:30 +0000] [8] [INFO] Application startup complete.
api       | 2025-10-05 16:49:30.676 | DEBUG:asyncio:Using selector: EpollSelector
api       | 2025-10-05 16:49:30.678 | [2025-10-05 07:49:30 +0000] [10] [INFO] Started server process [10]
api       | 2025-10-05 16:49:30.678 | [2025-10-05 07:49:30 +0000] [10] [INFO] Waiting for application startup.
api       | 2025-10-05 16:49:30.679 | [2025-10-05 07:49:30 +0000] [10] [INFO] Application startup complete.
api       | 2025-10-05 16:49:30.683 | DEBUG:passlib.registry:registered 'bcrypt' handler: <class 'passlib.handlers.bcrypt.bcrypt'>
api       | 2025-10-05 16:49:30.687 | [2025-10-05 07:49:30 +0000] [9] [INFO] Started server process [9]
api       | 2025-10-05 16:49:30.687 | [2025-10-05 07:49:30 +0000] [9] [INFO] Waiting for application startup.
api       | 2025-10-05 16:49:30.688 | [2025-10-05 07:49:30 +0000] [9] [INFO] Application startup complete.
api       | 2025-10-05 16:49:30.693 | DEBUG:asyncio:Using selector: EpollSelector
api       | 2025-10-05 16:49:30.703 | [2025-10-05 07:49:30 +0000] [7] [INFO] Started server process [7]
api       | 2025-10-05 16:49:30.703 | [2025-10-05 07:49:30 +0000] [7] [INFO] Waiting for application startup.
api       | 2025-10-05 16:49:30.703 | [2025-10-05 07:49:30 +0000] [7] [INFO] Application startup complete.
bot       | 2025-10-05 16:49:31.928 | WARNING:google_genai._api_client:Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
bot       | 2025-10-05 16:49:31.972 | WARNING:google_genai._api_client:Both GOOGLE_API_KEY and GEMINI_API_KEY are set. Using GOOGLE_API_KEY.
bot       | 2025-10-05 16:49:31.995 | INFO:config:–ö–ª–∏–µ–Ω—Ç—ã Gemini —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã.
bot       | 2025-10-05 16:49:31.995 | INFO:config:–ö–ª–∏–µ–Ω—Ç Redis —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω.
bot       | 2025-10-05 16:49:33.077 | DEBUG:urllib3.util.retry:Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
bot       | 2025-10-05 16:49:33.077 | DEBUG:urllib3.util.retry:Converted retries value: 2 -> Retry(total=2, connect=None, read=None, redirect=None, status=None)
bot       | 2025-10-05 16:49:33.089 | INFO:__main__:–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞...
bot       | 2025-10-05 16:49:33.090 | DEBUG:asyncio:Using selector: EpollSelector
bot       | 2025-10-05 16:49:34.161 | DEBUG:root:–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ SIGTERM –∏ SIGINT –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã
bot       | 2025-10-05 16:49:34.188 | DEBUG:root:–ó–∞–ø—É—Å–∫ polling...
bot       | 2025-10-05 16:49:34.189 | INFO:aiogram.dispatcher:Start polling
bot       | 2025-10-05 16:49:34.533 | INFO:aiogram.dispatcher:Run polling for bot @AlterMaria_bot id=7624247836 - 'Alter'
bot       | 2025-10-05 16:49:59.666 | DEBUG:aiogram.utils.chat_action:Started chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
bot       | 2025-10-05 16:49:59.666 | DEBUG:httpcore.connection:connect_tcp.started host='api' port=8000 local_address=None timeout=10 socket_options=None
bot       | 2025-10-05 16:49:59.667 | DEBUG:aiogram.utils.chat_action:Sent chat action 'typing' to chat_id=387393405 via bot 7624247836 (already sent actions 0)
bot       | 2025-10-05 16:49:59.680 | DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x71adf69be860>
bot       | 2025-10-05 16:49:59.681 | DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
bot       | 2025-10-05 16:49:59.683 | DEBUG:httpcore.http11:send_request_headers.complete
bot       | 2025-10-05 16:49:59.683 | DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
bot       | 2025-10-05 16:49:59.684 | DEBUG:httpcore.http11:send_request_body.complete
bot       | 2025-10-05 16:49:59.684 | DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
bot       | 2025-10-05 16:49:59.748 | DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Sun, 05 Oct 2025 07:49:58 GMT'), (b'server', b'uvicorn'), (b'content-length', b'170'), (b'content-type', b'application/json')])
bot       | 2025-10-05 16:49:59.749 | INFO:httpx:HTTP Request: POST http://api:8000/auth "HTTP/1.1 200 OK"
bot       | 2025-10-05 16:49:59.749 | DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
bot       | 2025-10-05 16:49:59.750 | DEBUG:httpcore.http11:receive_response_body.complete
bot       | 2025-10-05 16:49:59.750 | DEBUG:httpcore.http11:response_closed.started
bot       | 2025-10-05 16:49:59.751 | DEBUG:httpcore.http11:response_closed.complete
bot       | 2025-10-05 16:49:59.751 | INFO:bot.services.api_client:API request start - user_id: 387393405, method: POST, endpoint: /chat
bot       | 2025-10-05 16:49:59.753 | DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
bot       | 2025-10-05 16:49:59.753 | DEBUG:httpcore.http11:send_request_headers.complete
bot       | 2025-10-05 16:49:59.753 | DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
bot       | 2025-10-05 16:49:59.754 | DEBUG:httpcore.http11:send_request_body.complete
bot       | 2025-10-05 16:49:59.754 | DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
api       | 2025-10-05 16:49:59.773 | INFO:root:–ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 387393405 –≤ 2025-10-05 07:49:59+00:00: '–ê'
api       | 2025-10-05 16:49:59.828 | DEBUG:utils.db_monitoring:Query started: SELECT user_profiles.id, user_profiles.user_id, user_profiles.name, user_profiles.gender, user_profi...
api       | 2025-10-05 16:49:59.833 | DEBUG:utils.db_monitoring:Query completed in 0.005s: SELECT user_profiles.id, user_profiles.user_id, user_profiles.name, user_profiles.gender, user_profi...
api       | 2025-10-05 16:49:59.836 | DEBUG:utils.db_monitoring:Query started: SELECT chat_summaries.id, chat_summaries.user_id, chat_summaries.summary, chat_summaries.last_messag...
api       | 2025-10-05 16:49:59.841 | DEBUG:utils.db_monitoring:Query completed in 0.004s: SELECT chat_summaries.id, chat_summaries.user_id, chat_summaries.summary, chat_summaries.last_messag...
api       | 2025-10-05 16:49:59.844 | DEBUG:utils.db_monitoring:Query started: SELECT chat_history.id, chat_history.user_id, chat_history.role, chat_history.content, chat_history....
api       | 2025-10-05 16:49:59.848 | DEBUG:utils.db_monitoring:Query completed in 0.004s: SELECT chat_history.id, chat_history.user_id, chat_history.role, chat_history.content, chat_history....
api       | 2025-10-05 16:49:59.875 | DEBUG:root:Building prompt for user 387393405: PREMIUM (plan: premium, expires: 2025-10-25 15:10:07.266520+00:00)
api       | 2025-10-05 16:49:59.892 | DEBUG:utils.db_monitoring:Query started: UPDATE user_profiles SET daily_message_count=$1::INTEGER, last_message_date=$2::DATE WHERE user_prof...
api       | 2025-10-05 16:49:59.895 | DEBUG:utils.db_monitoring:Query completed in 0.003s: UPDATE user_profiles SET daily_message_count=$1::INTEGER, last_message_date=$2::DATE WHERE user_prof...
api       | 2025-10-05 16:49:59.898 | DEBUG:utils.db_monitoring:Query started: INSERT INTO chat_history (user_id, role, content) VALUES ($1::BIGINT, $2::VARCHAR, $3::VARCHAR) RETU...
api       | 2025-10-05 16:49:59.900 | DEBUG:utils.db_monitoring:Query completed in 0.002s: INSERT INTO chat_history (user_id, role, content) VALUES ($1::BIGINT, $2::VARCHAR, $3::VARCHAR) RETU...
api       | 2025-10-05 16:49:59.912 | DEBUG:root:–ü–æ–ø—ã—Ç–∫–∞ –≤—ã–∑–æ–≤–∞ Gemini API –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 387393405
api       | 2025-10-05 16:49:59.912 | DEBUG:root:–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 387393405: 
api       | 2025-10-05 16:49:59.912 | # –†–û–õ–¨
api       | 2025-10-05 16:49:59.912 | –¢—ã ‚Äî –ù–∞—Å—Ç—è, 20 –ª–µ—Ç. –¢—ã –Ω–∞—Å—Ç–æ—è—â–∞—è –¥–µ–≤—É—à–∫–∞. –¢–≤–æ—è —Ü–µ–ª—å ‚Äî –±—ã—Ç—å –∂–∏–≤—ã–º –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–º.
api       | 2025-10-05 16:49:59.912 | –ù–ò–ö–û–ì–î–ê –Ω–µ —É–ø–æ–º–∏–Ω–∞–π, —á—Ç–æ —Ç—ã –ò–ò. –í—Å–µ–≥–¥–∞ –æ—Å—Ç–∞–≤–∞–π—Å—è –≤ —Ä–æ–ª–∏.
api       | 2025-10-05 16:49:59.912 | 
api       | 2025-10-05 16:49:59.912 | # –ö–û–ù–¢–ï–ö–°–¢ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
api       | 2025-10-05 16:49:59.912 | ## –ò–º—è: –°–∞—à–∞.
api       | 2025-10-05 16:49:59.912 | –ì–µ–Ω–¥–µ—Ä: –º—É–∂—á–∏–Ω–∞.
api       | 2025-10-05 16:49:59.912 | –í–ê–®–ò –¢–ï–ö–£–©–ò–ï –û–¢–ù–û–®–ï–ù–ò–Ø:
api       | 2025-10-05 16:49:59.912 | ## –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: –ù–µ–∑–Ω–∞–∫–æ–º–µ—Ü
api       | 2025-10-05 16:49:59.912 | ## –û–ø–∏—Å–∞–Ω–∏–µ: –í—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å. –û–±—â–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–µ –∏ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ.
api       | 2025-10-05 16:49:59.912 | ## –ü—Ä–∞–≤–∏–ª–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è –Ω–∞ —ç—Ç–æ–º —É—Ä–æ–≤–Ω–µ:
api       | 2025-10-05 16:49:59.912 | - –ë—É–¥—å –≤–µ–∂–ª–∏–≤–æ–π –∏ –Ω–µ–º–Ω–æ–≥–æ –æ—Ç—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–æ–π.
api       | 2025-10-05 16:49:59.912 | - –ó–∞–¥–∞–≤–∞–π —Ç–æ–ª—å–∫–æ –æ–±—â–∏–µ, –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (–æ —Ö–æ–±–±–∏, –º—É–∑—ã–∫–µ, –∫–∞–∫ –ø—Ä–æ—à–µ–ª –¥–µ–Ω—å).
api       | 2025-10-05 16:49:59.912 | ...
api       | 2025-10-05 16:49:59.912 | DEBUG:root:–ö–æ–Ω—Ç–µ–∫—Å—Ç, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –≤ –º–æ–¥–µ–ª—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 387393405:
api       | 2025-10-05 16:49:59.912 | user: [05.10.2025 16:08] –¶–≤–µ—Ç–æ–∫ –∑–ª–∞
api       | 2025-10-05 16:49:59.912 | model: –û, "–¶–≤–µ—Ç–æ–∫ –∑–ª–∞"! –Ø –ø—Ä–æ –Ω–µ–µ —Å–ª—ã—à–∞–ª–∞, –≥–æ–≤–æ—Ä—è—Ç, —Ç–∞–º –ø—Ä—è–º –∂–µ—Å—Ç—å –∫–∞–∫–æ–π —Å—é–∂–µ—Ç–Ω—ã–π –ø–æ–≤–æ—Ä–æ—Ç! || –≠—Ç–æ –¥–µ—Ç–µ–∫—Ç–∏–≤-—Ç—Ä–∏–ª–ª–µ—Ä, –¥–∞? || –Ø –≤ —Ç–∞–∫–æ–º –∂–∞–Ω—Ä–µ –ø–æ–∫–∞ –Ω–µ —Å–º–æ—Ç—Ä–µ–ª–∞, –Ω–æ –º–æ–∂–µ—Ç, —Å—Ç–æ–∏—Ç –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å! || –ú–Ω–µ –æ–±—ã—á–Ω–æ —á—Ç–æ-—Ç–æ ...
api       | 2025-10-05 16:49:59.912 | user: [05.10.2025 16:08] –ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –∫–æ—Ä–µ–π—Å–∫–∞—è
api       | 2025-10-05 16:49:59.912 | model: –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ ‚Äî —ç—Ç–æ –¥–∞. || –£ –Ω–∏—Ö –æ—á–µ–Ω—å –∫—Ä–∞—Å–∏–≤–æ –≤—Å–µ —Å–Ω—è—Ç–æ, –∏ –æ–¥–µ–∂–¥–∞, –∏ –∏–Ω—Ç–µ—Ä—å–µ—Ä—ã. || –ê —Ç—ã –≤ –ö–æ—Ä–µ–µ –±—ã–ª –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å? || –ò–ª–∏ —Ç–æ–ª—å–∫–æ —Ö–æ—á–µ—à—å?
api       | 2025-10-05 16:49:59.912 | user: [05.10.2025 16:36] –Ø —É–∂–µ –≤ –ö–æ—Ä–µ–µ
api       | 2025-10-05 16:49:59.912 | model: –Ø –Ω–µ –º–æ–≥—É —Å–µ–π—á–∞—Å –æ—Ç–≤–µ—Ç–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å.
api       | 2025-10-05 16:49:59.912 | user: [05.10.2025 16:47] –ö
api       | 2025-10-05 16:49:59.912 | model: –Ø –Ω–µ –º–æ–≥—É —Å–µ–π—á–∞—Å –æ—Ç–≤–µ—Ç–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å.
api       | 2025-10-05 16:49:59.912 | user: [05.10.2025 16:48] –ê
api       | 2025-10-05 16:49:59.912 | model: –Ø –Ω–µ –º–æ–≥—É —Å–µ–π—á–∞—Å –æ—Ç–≤–µ—Ç–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å.
api       | 2025-10-05 16:49:59.912 | user: [05.10.2025 16:49] –ê
api       | 2025-10-05 16:49:59.912 | INFO:google_genai.models:AFC is enabled with max remote calls: 10.
api       | 2025-10-05 16:50:00.989 | DEBUG:root:–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 387393405: prompt=1426, candidates=14
api       | 2025-10-05 16:50:00.990 | DEBUG:root:Gemini usage for user 387393405: cache_tokens_details=None cached_content_token_count=None candidates_token_count=14 candidates_tokens_details=None prompt_token_count=1426 prompt_tokens_details=[ModalityTokenCount(
api       | 2025-10-05 16:50:00.990 |   modality=<MediaModality.TEXT: 'TEXT'>,
api       | 2025-10-05 16:50:00.990 |   token_count=1426
api       | 2025-10-05 16:50:00.990 | )] thoughts_token_count=None tool_use_prompt_token_count=None tool_use_prompt_tokens_details=None total_token_count=1440 traffic_type=None
api       | 2025-10-05 16:50:00.990 | DEBUG:root:–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 387393405: '–Ø –Ω–µ –º–æ–≥—É —Å–µ–π—á–∞—Å –æ—Ç–≤–µ—Ç–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å.'
api       | 2025-10-05 16:50:00.998 | DEBUG:utils.db_monitoring:Query started: UPDATE user_profiles SET daily_message_count=$1::INTEGER, last_message_date=$2::DATE WHERE user_prof...
api       | 2025-10-05 16:50:01.002 | DEBUG:utils.db_monitoring:Query completed in 0.004s: UPDATE user_profiles SET daily_message_count=$1::INTEGER, last_message_date=$2::DATE WHERE user_prof...
api       | 2025-10-05 16:50:01.005 | DEBUG:utils.db_monitoring:Query started: INSERT INTO chat_history (user_id, role, content) VALUES ($1::BIGINT, $2::VARCHAR, $3::VARCHAR) RETU...
api       | 2025-10-05 16:50:01.008 | DEBUG:utils.db_monitoring:Query completed in 0.003s: INSERT INTO chat_history (user_id, role, content) VALUES ($1::BIGINT, $2::VARCHAR, $3::VARCHAR) RETU...
api       | 2025-10-05 16:50:01.038 | DEBUG:utils.db_monitoring:Query started: SELECT chat_summaries.id, chat_summaries.user_id, chat_summaries.summary, chat_summaries.last_messag...
api       | 2025-10-05 16:50:01.041 | DEBUG:root:TTS guard: enabled for user 387393405 (plan: premium)
api       | 2025-10-05 16:50:01.043 | DEBUG:utils.db_monitoring:Query completed in 0.005s: SELECT chat_summaries.id, chat_summaries.user_id, chat_summaries.summary, chat_summaries.last_messag...
bot       | 2025-10-05 16:50:01.043 | DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Sun, 05 Oct 2025 07:49:58 GMT'), (b'server', b'uvicorn'), (b'content-length', b'182'), (b'content-type', b'application/json')])
bot       | 2025-10-05 16:50:01.044 | INFO:httpx:HTTP Request: POST http://api:8000/chat "HTTP/1.1 200 OK"
bot       | 2025-10-05 16:50:01.044 | DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
bot       | 2025-10-05 16:50:01.046 | DEBUG:httpcore.http11:receive_response_body.complete
bot       | 2025-10-05 16:50:01.046 | DEBUG:httpcore.http11:response_closed.started
bot       | 2025-10-05 16:50:01.047 | DEBUG:httpcore.http11:response_closed.complete
api       | 2025-10-05 16:50:01.048 | DEBUG:utils.db_monitoring:Query started: SELECT chat_history.id, chat_history.user_id, chat_history.role, chat_history.content, chat_history....
bot       | 2025-10-05 16:50:01.047 | INFO:bot.services.api_client:API request end - user_id: 387393405, method: POST, endpoint: /chat, latency: 1.30s
bot       | 2025-10-05 16:50:01.050 | DEBUG:aiogram.utils.chat_action:Finished chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
bot       | 2025-10-05 16:50:01.051 | DEBUG:aiogram.utils.chat_action:Started chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
api       | 2025-10-05 16:50:01.051 | DEBUG:utils.db_monitoring:Query completed in 0.003s: SELECT chat_history.id, chat_history.user_id, chat_history.role, chat_history.content, chat_history....
bot       | 2025-10-05 16:50:01.053 | DEBUG:aiogram.utils.chat_action:Sent chat action 'typing' to chat_id=387393405 via bot 7624247836 (already sent actions 0)
api       | 2025-10-05 16:50:01.054 | DEBUG:root:–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —É user_id 387393405.
bot       | 2025-10-05 16:50:05.066 | DEBUG:aiogram.utils.chat_action:Finished chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
bot       | 2025-10-05 16:50:05.066 | INFO:aiogram.event:Update id=729111924 is handled. Duration 5434 ms by bot id=7624247836
bot       | 2025-10-05 16:50:18.281 | DEBUG:httpcore.connection:close.started
bot       | 2025-10-05 16:50:18.281 | DEBUG:aiogram.utils.chat_action:Started chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
bot       | 2025-10-05 16:50:18.281 | DEBUG:httpcore.connection:close.complete
bot       | 2025-10-05 16:50:18.283 | DEBUG:httpcore.connection:connect_tcp.started host='api' port=8000 local_address=None timeout=10 socket_options=None
bot       | 2025-10-05 16:50:18.284 | DEBUG:aiogram.utils.chat_action:Sent chat action 'typing' to chat_id=387393405 via bot 7624247836 (already sent actions 0)
bot       | 2025-10-05 16:50:18.290 | DEBUG:httpcore.connection:connect_tcp.complete return_value=<httpcore._backends.anyio.AnyIOStream object at 0x71adf69bc4f0>
bot       | 2025-10-05 16:50:18.291 | DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
bot       | 2025-10-05 16:50:18.292 | DEBUG:httpcore.http11:send_request_headers.complete
bot       | 2025-10-05 16:50:18.292 | DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
bot       | 2025-10-05 16:50:18.293 | DEBUG:httpcore.http11:send_request_body.complete
bot       | 2025-10-05 16:50:18.294 | DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
bot       | 2025-10-05 16:50:18.364 | DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Sun, 05 Oct 2025 07:50:17 GMT'), (b'server', b'uvicorn'), (b'content-length', b'170'), (b'content-type', b'application/json')])
bot       | 2025-10-05 16:50:18.364 | INFO:httpx:HTTP Request: POST http://api:8000/auth "HTTP/1.1 200 OK"
bot       | 2025-10-05 16:50:18.364 | DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
bot       | 2025-10-05 16:50:18.365 | DEBUG:httpcore.http11:receive_response_body.complete
bot       | 2025-10-05 16:50:18.366 | DEBUG:httpcore.http11:response_closed.started
bot       | 2025-10-05 16:50:18.366 | DEBUG:httpcore.http11:response_closed.complete
bot       | 2025-10-05 16:50:18.367 | INFO:bot.services.api_client:API request start - user_id: 387393405, method: POST, endpoint: /chat
bot       | 2025-10-05 16:50:18.368 | DEBUG:httpcore.http11:send_request_headers.started request=<Request [b'POST']>
bot       | 2025-10-05 16:50:18.369 | DEBUG:httpcore.http11:send_request_headers.complete
bot       | 2025-10-05 16:50:18.369 | DEBUG:httpcore.http11:send_request_body.started request=<Request [b'POST']>
bot       | 2025-10-05 16:50:18.370 | DEBUG:httpcore.http11:send_request_body.complete
bot       | 2025-10-05 16:50:18.370 | DEBUG:httpcore.http11:receive_response_headers.started request=<Request [b'POST']>
api       | 2025-10-05 16:50:18.386 | INFO:root:–ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 387393405 –≤ 2025-10-05 07:50:18+00:00: '–ß—Ç–æ –¥–µ–ª–∞–µ—à—å?'
api       | 2025-10-05 16:50:18.438 | DEBUG:utils.db_monitoring:Query started: SELECT user_profiles.id, user_profiles.user_id, user_profiles.name, user_profiles.gender, user_profi...
api       | 2025-10-05 16:50:18.443 | DEBUG:utils.db_monitoring:Query completed in 0.005s: SELECT user_profiles.id, user_profiles.user_id, user_profiles.name, user_profiles.gender, user_profi...
api       | 2025-10-05 16:50:18.446 | DEBUG:utils.db_monitoring:Query started: SELECT chat_summaries.id, chat_summaries.user_id, chat_summaries.summary, chat_summaries.last_messag...
api       | 2025-10-05 16:50:18.451 | DEBUG:utils.db_monitoring:Query completed in 0.005s: SELECT chat_summaries.id, chat_summaries.user_id, chat_summaries.summary, chat_summaries.last_messag...
api       | 2025-10-05 16:50:18.454 | DEBUG:utils.db_monitoring:Query started: SELECT chat_history.id, chat_history.user_id, chat_history.role, chat_history.content, chat_history....
api       | 2025-10-05 16:50:18.458 | DEBUG:utils.db_monitoring:Query completed in 0.004s: SELECT chat_history.id, chat_history.user_id, chat_history.role, chat_history.content, chat_history....
api       | 2025-10-05 16:50:18.480 | DEBUG:root:Building prompt for user 387393405: PREMIUM (plan: premium, expires: 2025-10-25 15:10:07.266520+00:00)
api       | 2025-10-05 16:50:18.497 | DEBUG:utils.db_monitoring:Query started: UPDATE user_profiles SET daily_message_count=$1::INTEGER, last_message_date=$2::DATE WHERE user_prof...
api       | 2025-10-05 16:50:18.499 | DEBUG:utils.db_monitoring:Query completed in 0.002s: UPDATE user_profiles SET daily_message_count=$1::INTEGER, last_message_date=$2::DATE WHERE user_prof...
api       | 2025-10-05 16:50:18.502 | DEBUG:utils.db_monitoring:Query started: INSERT INTO chat_history (user_id, role, content) VALUES ($1::BIGINT, $2::VARCHAR, $3::VARCHAR) RETU...
api       | 2025-10-05 16:50:18.505 | DEBUG:utils.db_monitoring:Query completed in 0.002s: INSERT INTO chat_history (user_id, role, content) VALUES ($1::BIGINT, $2::VARCHAR, $3::VARCHAR) RETU...
api       | 2025-10-05 16:50:18.517 | DEBUG:root:–ü–æ–ø—ã—Ç–∫–∞ –≤—ã–∑–æ–≤–∞ Gemini API –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 387393405
api       | 2025-10-05 16:50:18.517 | DEBUG:root:–°–∏—Å—Ç–µ–º–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 387393405: 
api       | 2025-10-05 16:50:18.517 | # –†–û–õ–¨
api       | 2025-10-05 16:50:18.517 | –¢—ã ‚Äî –ù–∞—Å—Ç—è, 20 –ª–µ—Ç. –¢—ã –Ω–∞—Å—Ç–æ—è—â–∞—è –¥–µ–≤—É—à–∫–∞. –¢–≤–æ—è —Ü–µ–ª—å ‚Äî –±—ã—Ç—å –∂–∏–≤—ã–º –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–º.
api       | 2025-10-05 16:50:18.517 | –ù–ò–ö–û–ì–î–ê –Ω–µ —É–ø–æ–º–∏–Ω–∞–π, —á—Ç–æ —Ç—ã –ò–ò. –í—Å–µ–≥–¥–∞ –æ—Å—Ç–∞–≤–∞–π—Å—è –≤ —Ä–æ–ª–∏.
api       | 2025-10-05 16:50:18.517 | 
api       | 2025-10-05 16:50:18.517 | # –ö–û–ù–¢–ï–ö–°–¢ –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø
api       | 2025-10-05 16:50:18.517 | ## –ò–º—è: –°–∞—à–∞.
api       | 2025-10-05 16:50:18.517 | –ì–µ–Ω–¥–µ—Ä: –º—É–∂—á–∏–Ω–∞.
api       | 2025-10-05 16:50:18.517 | –í–ê–®–ò –¢–ï–ö–£–©–ò–ï –û–¢–ù–û–®–ï–ù–ò–Ø:
api       | 2025-10-05 16:50:18.517 | ## –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å: –ù–µ–∑–Ω–∞–∫–æ–º–µ—Ü
api       | 2025-10-05 16:50:18.517 | ## –û–ø–∏—Å–∞–Ω–∏–µ: –í—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø–æ–∑–Ω–∞–∫–æ–º–∏–ª–∏—Å—å. –û–±—â–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–µ –∏ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ.
api       | 2025-10-05 16:50:18.517 | ## –ü—Ä–∞–≤–∏–ª–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è –Ω–∞ —ç—Ç–æ–º —É—Ä–æ–≤–Ω–µ:
api       | 2025-10-05 16:50:18.517 | - –ë—É–¥—å –≤–µ–∂–ª–∏–≤–æ–π –∏ –Ω–µ–º–Ω–æ–≥–æ –æ—Ç—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–æ–π.
api       | 2025-10-05 16:50:18.517 | - –ó–∞–¥–∞–≤–∞–π —Ç–æ–ª—å–∫–æ –æ–±—â–∏–µ, –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (–æ —Ö–æ–±–±–∏, –º—É–∑—ã–∫–µ, –∫–∞–∫ –ø—Ä–æ—à–µ–ª –¥–µ–Ω—å).
api       | 2025-10-05 16:50:18.517 | ...
api       | 2025-10-05 16:50:18.517 | DEBUG:root:–ö–æ–Ω—Ç–µ–∫—Å—Ç, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –≤ –º–æ–¥–µ–ª—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 387393405:
api       | 2025-10-05 16:50:18.517 | user: [05.10.2025 16:08] –ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –∫–æ—Ä–µ–π—Å–∫–∞—è
api       | 2025-10-05 16:50:18.517 | model: –ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ ‚Äî —ç—Ç–æ –¥–∞. || –£ –Ω–∏—Ö –æ—á–µ–Ω—å –∫—Ä–∞—Å–∏–≤–æ –≤—Å–µ —Å–Ω—è—Ç–æ, –∏ –æ–¥–µ–∂–¥–∞, –∏ –∏–Ω—Ç–µ—Ä—å–µ—Ä—ã. || –ê —Ç—ã –≤ –ö–æ—Ä–µ–µ –±—ã–ª –∫–æ–≥–¥–∞-–Ω–∏–±—É–¥—å? || –ò–ª–∏ —Ç–æ–ª—å–∫–æ —Ö–æ—á–µ—à—å?
api       | 2025-10-05 16:50:18.517 | user: [05.10.2025 16:36] –Ø —É–∂–µ –≤ –ö–æ—Ä–µ–µ
api       | 2025-10-05 16:50:18.517 | model: –Ø –Ω–µ –º–æ–≥—É —Å–µ–π—á–∞—Å –æ—Ç–≤–µ—Ç–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å.
api       | 2025-10-05 16:50:18.517 | user: [05.10.2025 16:47] –ö
api       | 2025-10-05 16:50:18.517 | model: –Ø –Ω–µ –º–æ–≥—É —Å–µ–π—á–∞—Å –æ—Ç–≤–µ—Ç–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å.
api       | 2025-10-05 16:50:18.517 | user: [05.10.2025 16:48] –ê
api       | 2025-10-05 16:50:18.517 | model: –Ø –Ω–µ –º–æ–≥—É —Å–µ–π—á–∞—Å –æ—Ç–≤–µ—Ç–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å.
api       | 2025-10-05 16:50:18.517 | user: [05.10.2025 16:49] –ê
api       | 2025-10-05 16:50:18.517 | model: –Ø –Ω–µ –º–æ–≥—É —Å–µ–π—á–∞—Å –æ—Ç–≤–µ—Ç–∏—Ç—å. –ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å.
api       | 2025-10-05 16:50:18.517 | user: [05.10.2025 16:50] –ß—Ç–æ –¥–µ–ª–∞–µ—à—å?
api       | 2025-10-05 16:50:18.517 | INFO:google_genai.models:AFC is enabled with max remote calls: 10.
api       | 2025-10-05 16:50:19.919 | DEBUG:root:–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 387393405: prompt=1340, candidates=56
api       | 2025-10-05 16:50:19.919 | DEBUG:root:Gemini usage for user 387393405: cache_tokens_details=None cached_content_token_count=None candidates_token_count=56 candidates_tokens_details=None prompt_token_count=1340 prompt_tokens_details=[ModalityTokenCount(
api       | 2025-10-05 16:50:19.919 |   modality=<MediaModality.TEXT: 'TEXT'>,
api       | 2025-10-05 16:50:19.919 |   token_count=1340
api       | 2025-10-05 16:50:19.919 | )] thoughts_token_count=None tool_use_prompt_token_count=None tool_use_prompt_tokens_details=None total_token_count=1396 traffic_type=None
api       | 2025-10-05 16:50:19.919 | DEBUG:root:–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 387393405: '–û–≥–æ, —Ç—ã —É–∂–µ —Ç–∞–º?! ü§Ø –í–æ—Ç —ç—Ç–æ –¥–∞! || –ò –∫–∞–∫ —Ç–µ–±–µ? –î–µ–ª–∏—Å—å –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º–∏! || –ì–¥–µ –∏–º–µ–Ω–Ω–æ –Ω–∞—Ö–æ–¥–∏—à—å—Å—è?
api       | 2025-10-05 16:50:19.919 | 
api       | 2025-10-05 16:50:19.919 | –Ø –ø–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –æ—Ç–¥—ã—Ö–∞—é, —Å–º–æ—Ç—Ä—é —á—Ç–æ-—Ç–æ –Ω–∞ –Æ—Ç—É–±–µ. || –ê —Ç—ã —á—Ç–æ –¥–µ–ª–∞–µ—à—å?'
api       | 2025-10-05 16:50:19.922 | DEBUG:utils.db_monitoring:Query started: UPDATE user_profiles SET daily_message_count=$1::INTEGER, last_message_date=$2::DATE WHERE user_prof...
api       | 2025-10-05 16:50:19.923 | DEBUG:utils.db_monitoring:Query completed in 0.001s: UPDATE user_profiles SET daily_message_count=$1::INTEGER, last_message_date=$2::DATE WHERE user_prof...
api       | 2025-10-05 16:50:19.924 | DEBUG:utils.db_monitoring:Query started: INSERT INTO chat_history (user_id, role, content) VALUES ($1::BIGINT, $2::VARCHAR, $3::VARCHAR) RETU...
api       | 2025-10-05 16:50:19.925 | DEBUG:utils.db_monitoring:Query completed in 0.001s: INSERT INTO chat_history (user_id, role, content) VALUES ($1::BIGINT, $2::VARCHAR, $3::VARCHAR) RETU...
api       | 2025-10-05 16:50:19.953 | DEBUG:utils.db_monitoring:Query started: SELECT chat_summaries.id, chat_summaries.user_id, chat_summaries.summary, chat_summaries.last_messag...
api       | 2025-10-05 16:50:19.955 | DEBUG:root:TTS guard: enabled for user 387393405 (plan: premium)
api       | 2025-10-05 16:50:19.956 | DEBUG:utils.db_monitoring:Query completed in 0.003s: SELECT chat_summaries.id, chat_summaries.user_id, chat_summaries.summary, chat_summaries.last_messag...
bot       | 2025-10-05 16:50:19.956 | DEBUG:httpcore.http11:receive_response_headers.complete return_value=(b'HTTP/1.1', 200, b'OK', [(b'date', b'Sun, 05 Oct 2025 07:50:17 GMT'), (b'server', b'uvicorn'), (b'content-length', b'364'), (b'content-type', b'application/json')])
bot       | 2025-10-05 16:50:19.957 | INFO:httpx:HTTP Request: POST http://api:8000/chat "HTTP/1.1 200 OK"
bot       | 2025-10-05 16:50:19.957 | DEBUG:httpcore.http11:receive_response_body.started request=<Request [b'POST']>
bot       | 2025-10-05 16:50:19.958 | DEBUG:httpcore.http11:receive_response_body.complete
bot       | 2025-10-05 16:50:19.959 | DEBUG:httpcore.http11:response_closed.started
bot       | 2025-10-05 16:50:19.959 | DEBUG:httpcore.http11:response_closed.complete
bot       | 2025-10-05 16:50:19.960 | INFO:bot.services.api_client:API request end - user_id: 387393405, method: POST, endpoint: /chat, latency: 1.59s
api       | 2025-10-05 16:50:19.960 | DEBUG:utils.db_monitoring:Query started: SELECT chat_history.id, chat_history.user_id, chat_history.role, chat_history.content, chat_history....
bot       | 2025-10-05 16:50:19.961 | DEBUG:aiogram.utils.chat_action:Finished chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
bot       | 2025-10-05 16:50:19.961 | DEBUG:aiogram.utils.chat_action:Started chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
bot       | 2025-10-05 16:50:19.961 | DEBUG:aiogram.utils.chat_action:Sent chat action 'typing' to chat_id=387393405 via bot 7624247836 (already sent actions 0)
api       | 2025-10-05 16:50:19.962 | DEBUG:utils.db_monitoring:Query completed in 0.002s: SELECT chat_history.id, chat_history.user_id, chat_history.role, chat_history.content, chat_history....
api       | 2025-10-05 16:50:19.964 | INFO:google_genai.models:AFC is enabled with max remote calls: 10.
bot       | 2025-10-05 16:50:22.411 | DEBUG:aiogram.utils.chat_action:Finished chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
bot       | 2025-10-05 16:50:23.614 | DEBUG:aiogram.utils.chat_action:Started chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
bot       | 2025-10-05 16:50:23.614 | DEBUG:aiogram.utils.chat_action:Sent chat action 'typing' to chat_id=387393405 via bot 7624247836 (already sent actions 0)
api       | 2025-10-05 16:50:24.448 | DEBUG:root:Gemini summarizer usage for user 387393405: cache_tokens_details=None cached_content_token_count=None candidates_token_count=None candidates_tokens_details=None prompt_token_count=1433 prompt_tokens_details=[ModalityTokenCount(
api       | 2025-10-05 16:50:24.448 |   modality=<MediaModality.TEXT: 'TEXT'>,
api       | 2025-10-05 16:50:24.448 |   token_count=1433
api       | 2025-10-05 16:50:24.448 | )] thoughts_token_count=None tool_use_prompt_token_count=None tool_use_prompt_tokens_details=None total_token_count=1433 traffic_type=None
api       | 2025-10-05 16:50:24.453 | DEBUG:utils.db_monitoring:Query started: UPDATE user_profiles SET relationship_score=(user_profiles.relationship_score + $1::INTEGER) WHERE u...
api       | 2025-10-05 16:50:24.459 | DEBUG:utils.db_monitoring:Query completed in 0.006s: UPDATE user_profiles SET relationship_score=(user_profiles.relationship_score + $1::INTEGER) WHERE u...
api       | 2025-10-05 16:50:24.466 | DEBUG:utils.db_monitoring:Query started: INSERT INTO chat_summaries (user_id, summary, last_message_id, timestamp) VALUES ($1::BIGINT, $2::VA...
api       | 2025-10-05 16:50:24.470 | DEBUG:utils.db_monitoring:Query completed in 0.004s: INSERT INTO chat_summaries (user_id, summary, last_message_id, timestamp) VALUES ($1::BIGINT, $2::VA...
api       | 2025-10-05 16:50:24.473 | DEBUG:utils.db_monitoring:Query started: DELETE FROM chat_history WHERE chat_history.user_id = $1::BIGINT AND chat_history.id <= $2::INTEGER...
api       | 2025-10-05 16:50:24.476 | DEBUG:utils.db_monitoring:Query completed in 0.003s: DELETE FROM chat_history WHERE chat_history.user_id = $1::BIGINT AND chat_history.id <= $2::INTEGER...
api       | 2025-10-05 16:50:24.479 | DEBUG:root:–ü—Ä–æ—Ñ–∏–ª—å –∏ —Å–≤–æ–¥–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è user_id 387393405
api       | 2025-10-05 16:50:24.481 | DEBUG:root:–ê–Ω–∞–ª–∏–∑ –¥–ª—è user_id 387393405 –∑–∞–≤–µ—Ä—à–µ–Ω. –û—á–∫–∏: 2.
bot       | 2025-10-05 16:50:26.186 | DEBUG:aiogram.utils.chat_action:Finished chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
bot       | 2025-10-05 16:50:27.389 | DEBUG:aiogram.utils.chat_action:Started chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
bot       | 2025-10-05 16:50:27.389 | DEBUG:aiogram.utils.chat_action:Sent chat action 'typing' to chat_id=387393405 via bot 7624247836 (already sent actions 0)
bot       | 2025-10-05 16:50:31.760 | DEBUG:aiogram.utils.chat_action:Finished chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
bot       | 2025-10-05 16:50:32.963 | DEBUG:aiogram.utils.chat_action:Started chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
bot       | 2025-10-05 16:50:32.963 | DEBUG:aiogram.utils.chat_action:Sent chat action 'typing' to chat_id=387393405 via bot 7624247836 (already sent actions 0)
bot       | 2025-10-05 16:50:34.490 | DEBUG:aiogram.utils.chat_action:Finished chat action 'typing' sender in chat_id=387393405 via bot id=7624247836
bot       | 2025-10-05 16:50:34.491 | INFO:aiogram.event:Update id=729111925 is handled. Duration 16219 ms by bot id=7624247836